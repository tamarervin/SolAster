
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="SDO HMI RV Pipeline Documentation">
      
      
      
      
      <link rel="icon" href="../../img/sun.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.1">
    
    
      
        <title>Magnetic Observables - SDO HMI RV Pipeline</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1c75ef36.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7COswald&display=fallback">
        <style>:root{--md-text-font-family:"";--md-code-font-family:"Oswald"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#calculation-of-solar-magnetic-observables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SDO HMI RV Pipeline" class="md-header__button md-logo" aria-label="SDO HMI RV Pipeline" data-md-component="logo">
      
  <img src="../../img/sun.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SDO HMI RV Pipeline
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Magnetic Observables
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/tamarervin/sdo_hmi_rvs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SDO HMI RV Pipeline" class="md-nav__button md-logo" aria-label="SDO HMI RV Pipeline" data-md-component="logo">
      
  <img src="../../img/sun.png" alt="logo">

    </a>
    SDO HMI RV Pipeline
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/tamarervin/sdo_hmi_rvs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          HMI Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="HMI Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          HMI Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        Aquiring Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../corr/" class="md-nav__link">
        Data Corrections
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../coords/" class="md-nav__link">
        Coordinate Transformations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../region/" class="md-nav__link">
        Region Identification
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vel/" class="md-nav__link">
        Velocity Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../rv/" class="md-nav__link">
        RV Calculation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Magnetic Observables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Magnetic Observables
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filling-factor" class="md-nav__link">
    Filling Factor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unsigned-magnetic-flux" class="md-nav__link">
    Unsigned Magnetic Flux
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#area-based-magnetic-observables" class="md-nav__link">
    Area Based Magnetic Observables
  </a>
  
    <nav class="md-nav" aria-label="Area Based Magnetic Observables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#area-thresholded-filling-factor" class="md-nav__link">
    Area Thresholded Filling Factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#area-thresholded-unsigned-flux" class="md-nav__link">
    Area Thresholded Unsigned Flux
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Jupyter Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Jupyter Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Jupyter Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/docs_sunpy_example/" class="md-nav__link">
        Sunpy Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/docs_solar_corrections/" class="md-nav__link">
        Component Calculations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/docs_rv_calcs/" class="md-nav__link">
        RV Calculation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/rv_calculation/" class="md-nav__link">
        Full Pipeline
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filling-factor" class="md-nav__link">
    Filling Factor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unsigned-magnetic-flux" class="md-nav__link">
    Unsigned Magnetic Flux
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#area-based-magnetic-observables" class="md-nav__link">
    Area Based Magnetic Observables
  </a>
  
    <nav class="md-nav" aria-label="Area Based Magnetic Observables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#area-thresholded-filling-factor" class="md-nav__link">
    Area Thresholded Filling Factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#area-thresholded-unsigned-flux" class="md-nav__link">
    Area Thresholded Unsigned Flux
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/tamarervin/sdo_hmi_rvs/blob/master/mkdocs/docs/sdo/mag.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="calculation-of-solar-magnetic-observables">Calculation of Solar Magnetic Observables</h1>
<p>Using HMI magnetograms, we are able to calculate magnetic observables that
both correlate with each other as well as the velocity features. This shows 
how the magnetic activity is driving the radial velocity variations.  </p>
<h2 id="filling-factor">Filling Factor</h2>
<p><strong>Disk averaged filling factors of sunspots and plage which gives
the percentage of magnetically active pixels.</strong>  </p>
<p>The filling factor is a calculation of the percentage of active pixels on the solar
surface at any one time. We calculate three different factors: <span class="arithmatex"><span class="MathJax_Preview">f_{spot}</span><script type="math/tex">f_{spot}</script></span>, <span class="arithmatex"><span class="MathJax_Preview">f_{bright}</span><script type="math/tex">f_{bright}</script></span>,
and <span class="arithmatex"><span class="MathJax_Preview">f</span><script type="math/tex">f</script></span>. These are the filling factors due to sunspots, faculae/network, and the total
filling factor which is the sum of the two.  </p>
<p>We return the filling factor as a percentage:<br />
<span class="arithmatex"><span class="MathJax_Preview">f = \frac{1}{N_{pix}} \sum_{ij} W_{ij} * 100</span><script type="math/tex">f = \frac{1}{N_{pix}} \sum_{ij} W_{ij} * 100</script></span></p>
<pre><code class="language-python">def filling_factor(mu, mmap, active, fac_inds, spot_inds, mu_cutoff=0.3):
    &quot;&quot;&quot;
    function to calculate filling factor

    Parameters
    ----------
    mu: array of mu (cosine theta) values
    mmap: UNCORRECTED Sunpy map object (Magnetogram)
    active: weights array where active pixels have weight = 1
    fac_inds: array of indices where faculae are detected
    spot_inds: array of indices where sunspots are detected
    mu_cutoff: minimum mu cutoff value

    Returns
    -------
    f_bright: filling factor (%) for bright areas (faculae)
    f_spot: filling factor (%) for dark areas (sunspots)
    f_total: filling factor (%) for timestamp

    &quot;&quot;&quot;

    # get good mu values
    good_mu = np.where(mu &gt; mu_cutoff)

    # get number of pixels
    npix = len(mmap.data[good_mu])

    # faculae
    faculae = np.zeros(mmap.data.shape)
    faculae[fac_inds] = 1.
    f_bright = np.sum(faculae) / npix * 100

    # sunspots
    spots = np.zeros(mmap.data.shape)
    spots[spot_inds] = 1.
    f_spot = np.sum(spots) / npix * 100

    # get filling factor
    f_total = np.sum(active) / npix * 100

    return f_bright, f_spot, f_total
</code></pre>
<h2 id="unsigned-magnetic-flux">Unsigned Magnetic Flux</h2>
<p><strong>The disc-averaged, line-of-sight unsigned (unpolarized) magnetic flux of the Sun.</strong></p>
<p><span class="arithmatex"><span class="MathJax_Preview">|\hat{B_{obs}}| = \frac{\sum_{ij} |B_{obs, ij}| I_{ij}} {\sum_{ij} I_{ij}}</span><script type="math/tex">|\hat{B_{obs}}| = \frac{\sum_{ij} |B_{obs, ij}| I_{ij}} {\sum_{ij} I_{ij}}</script></span></p>
<pre><code class="language-python">def unsigned_flux(map_mag_obs, imap):
    &quot;&quot;&quot;
    calculate unsigned magnetic flux

    Parameters
    ----------
    map_mag_obs: corrected observed magnetic field strength Sunpy map object (Magnetogram)
    imap: UNCORRECTED Sunpy map object (Intensitygram)

    Returns
    -------
    unsign_flux: unsigned magnetic flux

    &quot;&quot;&quot;

    unsign_flux = np.nansum(np.abs(map_mag_obs.data) * imap.data) / np.nansum(imap.data)

    return np.abs(unsign_flux)
</code></pre>
<h2 id="area-based-magnetic-observables">Area Based Magnetic Observables</h2>
<p>In addition to the unsigned flux and filling factor calculations described above, we calculate
these quantities with an eye for what types of regions are causing variations in magnetic
activity. The calculations for area thresholded regions is outlined below.</p>
<h3 id="area-thresholded-filling-factor">Area Thresholded Filling Factor</h3>
<pre><code class="language-python">def area_filling_factor(active, area, mu, mmap, fac_inds, athresh=20, mu_cutoff=0.3):
    &quot;&quot;&quot;
    calculate filling factor for regions thresholded by area
    - differentiate between large and small regions
    - differentiate between plage (large) and network (small) bright regions

    Parameters
    ----------
    active: weights array where active pixels have weight = 1
    area: area of each active region weighted by its intensity
    mu: array of mu (cosine theta) values
    mmap: UNCORRECTED Sunpy map object (Magnetogram)
    fac_inds: array of indices where faculae are detected
    athresh: area threshold value between large and small regions (in uHem)
    mu_cutoff: minimum mu cutoff value for usable data

    Returns
    -------
    f_small: filling factor (%) for small magnetically active regions
    f_large: filling factor (%) for large magnetically active regions
    f_network: filling factor (%) for network (small, bright magnetically active) regions
    f_plage: filling factor (%) for plage (large, bright magnetically active) regions
    f_nonconv: filling factor (%) for regions that do not suppress convective blueshift

    &quot;&quot;&quot;

    # get good mu values
    good_mu = np.where(mu &gt; mu_cutoff)

    # get number of pixels
    npix = len(mmap.data[good_mu])

    # get quiet pixels
    quiet = 1 - active

    # get filling factor for 'small' magnetic features
    small = np.zeros(mmap.data.shape)
    small_inds = np.logical_and(active &gt; 0.5, area &lt; athresh)
    small[small_inds] = 1.
    f_small = np.nansum(small) / npix * 100

    # get filling factor for 'large' magnetic features
    large = np.zeros(mmap.data.shape)
    large_inds = np.logical_and(active &gt; 0.5, area &gt; athresh)
    large[large_inds] = 1.
    f_large = np.nansum(large) / npix * 100

    # get filling factor for network (small, faculae regions)
    network = np.zeros(mmap.data.shape)
    network_inds = np.logical_and(small &gt; 0.5, fac_inds &gt; 0.5)
    network[network_inds] = 1.
    f_network = np.nansum(network) / npix * 100

    # get filling factor for plage (large, faculae regions)
    plage = np.zeros(mmap.data.shape)
    plage_inds = np.logical_and(large &gt; 0.5, fac_inds &gt; 0.5)
    plage[plage_inds] = 1.
    f_plage = np.nansum(plage) / npix * 100

    # get filling factor for small, non-convective regions
    nonconv = np.zeros(mmap.data.shape)
    nonconv_inds = np.logical_and(quiet &gt; 0.5, small &gt; 0.5)
    nonconv[nonconv_inds] = 1.
    f_nonconv = np.nansum(nonconv) / npix * 100

    return f_small, f_large, f_network, f_plage, f_nonconv
</code></pre>
<h3 id="area-thresholded-unsigned-flux">Area Thresholded Unsigned Flux</h3>
<pre><code class="language-python">def area_unsigned_flux(map_mag_obs, imap, area, active, athresh=20):
    &quot;&quot;&quot;
    calculate the magnetic flux for different regions based on area cut
    and magnetic activitiy

    Parameters
    ----------
    map_mag_obs: corrected observed magnetic field strength Sunpy map object (Magnetogram)
    imap: UNCORRECTED Sunpy map object (Intensitygram)
    area: area of each active region weighted by its intensity
    active: weights array where active pixels have weight = 1

    Returns
    -------
    quiet_flux: magnetic flux of quiet-Sun regions
    ar_flux: magnetic flux of active regions
    conv_flux: magnetic flux of regions that suppress convective blueshift
    pol_flux: magnetic flux of polarized regions
    pol_conv_flux: magnetic flux of polarized regions that suppress the convective blueshift

    &quot;&quot;&quot;

    # get data arrays
    i_data = imap.data
    m_data = map_mag_obs.data
    mabs_data = np.abs(m_data)
    quiet = 1 - active

    # get large regions array
    large = np.zeros(m_data.shape)
    large_inds = np.logical_and(active &gt; 0.5, area &gt; athresh)
    large[large_inds] = 1.

    # calculate relevant fluxes
    quiet_flux = np.nansum(mabs_data * i_data * quiet) / np.nansum(i_data * quiet)
    ar_flux = np.nansum(mabs_data * i_data * active) / np.nansum(i_data * active)
    conv_flux = np.nansum(mabs_data * i_data * large) / np.nansum(i_data * large)
    pol_flux = np.nansum(m_data * i_data) / np.nansum(i_data)
    pol_conv_flux = np.nansum(m_data * i_data * large) / np.nansum(i_data * large)

    return quiet_flux, ar_flux, conv_flux, pol_flux, pol_conv_flux
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../rv/" class="md-footer__link md-footer__link--prev" aria-label="Previous: RV Calculation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              RV Calculation
            </div>
          </div>
        </a>
      
      
        
        <a href="../examples/docs_sunpy_example/" class="md-footer__link md-footer__link--next" aria-label="Next: Sunpy Basics" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Sunpy Basics
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "header.autohide"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c7d1b464.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>